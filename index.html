<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Мини-курс: Сбой Wi-Fi с aireplay-ng</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;400&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0; padding: 0; min-height: 100vh;
      background: #181b1f;
      color: #fff;
      font-family: 'Montserrat', 'Oswald', Arial, sans-serif;
      font-size: 16px;
      box-sizing: border-box;
      overflow-x: hidden;
      max-width: 100vw;
      position: relative;
    }
    body {
      min-height: 100vh;
      width: 100vw;
      position: relative;
    }
    /* SVG-анимированный фон */
    #cyber-bg {
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh;
      z-index: 0;
      pointer-events: none;
      opacity: 0.18;
    }
    header {
      background: transparent;
      padding: 2.2rem 1rem 1.2rem 1rem;
      text-align: center;
      z-index: 2;
      position: relative;
      animation: fadein 1.2s cubic-bezier(.4,0,.2,1);
    }
    header h1 {
      margin: 0;
      font-size: 2.1rem;
      color: #fff;
      letter-spacing: 0.13em;
      font-weight: 700;
      text-transform: uppercase;
      line-height: 1.1;
      text-shadow: 0 2px 16px #000a;
      animation: slidein-top 1.2s cubic-bezier(.4,0,.2,1);
    }
    header .subtitle {
      color: #b0b6be;
      font-size: 1.05em;
      margin-top: 0.7em;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      animation: fadein 1.5s cubic-bezier(.4,0,.2,1);
    }
    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1.5rem 0.5rem 2.5rem 0.5rem;
      max-width: 100vw;
      margin: 0 auto;
      width: 100%;
      box-sizing: border-box;
      min-width: 0;
      z-index: 2;
      position: relative;
    }
    .progress {
      width: 100%;
      height: 8px;
      background: #23272b;
      border-radius: 3px;
      margin: 1.2rem 0 1.5rem 0;
      overflow: hidden;
      max-width: 100vw;
      min-width: 0;
      box-sizing: border-box;
      border: 1.5px solid #fff2;
      box-shadow: 0 0 12px #ff2a2a33;
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #ff2a2a 0%, #fff 100%);
      width: 0%;
      transition: width 0.7s cubic-bezier(.4,0,.2,1);
      box-shadow: 0 0 16px #ff2a2a88;
      animation: cyber-bar 2.5s infinite linear alternate;
    }
    @keyframes cyber-bar {
      0% { filter: brightness(1.1); }
      50% { filter: brightness(1.5) drop-shadow(0 0 8px #ff2a2a); }
      100% { filter: brightness(1.1); }
    }
    .card {
      background: rgba(24,27,31,0.98);
      border-radius: 18px;
      box-shadow: 0 2px 24px #000a;
      padding: 1.2rem 1rem;
      margin-bottom: 1.2rem;
      width: 100%;
      max-width: 700px;
      transition: box-shadow 0.2s;
      box-sizing: border-box;
      min-width: 0;
      border: 2px solid #fff2;
      position: relative;
      overflow: hidden;
      animation: fadein 1.2s cubic-bezier(.4,0,.2,1);
    }
    .card.active {
      border: 2px solid #ff2a2a;
      box-shadow: 0 0 0 2px #fff, 0 2px 24px #000a;
    }
    .step-title {
      color: #fff;
      font-size: 1.25rem;
      margin-bottom: 0.7rem;
      font-weight: 700;
      letter-spacing: 0.09em;
      text-transform: uppercase;
      border-left: 4px solid #ff2a2a;
      padding-left: 0.7em;
      max-width: 100vw;
      min-width: 0;
      box-sizing: border-box;
      animation: slidein-left 1.2s cubic-bezier(.4,0,.2,1);
    }
    .terminal, .simulator {
      background: #181b1f;
      color: #fff;
      border-radius: 10px;
      padding: 0.9rem 1rem;
      font-size: 1.05em;
      margin: 0.7rem 0 0.7rem 0;
      font-family: 'JetBrains Mono', 'Consolas', monospace;
      box-shadow: 0 1px 8px #0008;
      position: relative;
      overflow-x: auto;
      border: 1.5px solid #fff2;
    }
    .terminal .prompt {
      color: #ff2a2a;
      font-weight: 700;
    }
    .terminal .output {
      color: #b0b6be;
      display: block;
      margin-top: 0.2em;
    }
    .test label {
      color: #fff;
      font-size: 1em;
      font-weight: 700;
      margin-bottom: 0.5em;
      letter-spacing: 0.04em;
    }
    .test input[type="text"] {
      width: 100%;
      padding: 0.6em;
      border-radius: 8px;
      border: 1.5px solid #ff2a2a;
      background: #181b1f;
      color: #fff;
      font-family: inherit;
      font-size: 1.05em;
      margin-bottom: 0.7em;
      box-sizing: border-box;
    }
    .test button {
      background: #ff2a2a;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.6em 1.3em;
      font-size: 1.05em;
      font-family: inherit;
      cursor: pointer;
      transition: background 0.2s;
      margin-top: 0.2em;
      font-weight: 700;
      letter-spacing: 0.04em;
      box-shadow: 0 1px 8px #0008;
    }
    .test button:active {
      background: #fff;
      color: #ff2a2a;
    }
    .test .result {
      margin-top: 0.5em;
      font-size: 1em;
      font-weight: 700;
    }
    .mini-pc { display: flex; justify-content: center; margin: 1.2em 0; width: 100%; max-width: 100vw; overflow-x: hidden; box-sizing: border-box; min-width: 0; }
    .pc-body { background: rgba(24,27,31,0.98); border-radius: 18px; box-shadow: 0 4px 32px #000a; padding: 1.2em 1em 1em 1em; width: 98vw; max-width: 400px; min-width: 0; position: relative; border: 2px solid #fff2; margin: 0 auto; overflow: hidden; box-sizing: border-box; }
    .pc-screen { background: #111216; border-radius: 12px; box-shadow: 0 2px 12px #0008, 0 0 0 2px #fff2 inset; width: 100%; min-height: 100px; height: 32vw; max-height: 180px; margin-bottom: 1em; display: flex; align-items: flex-end; overflow: hidden; position: relative; min-width: 0; max-width: 100%; box-sizing: border-box; border: 2px solid #fff2; }
    .pc-terminal { color: #fff; font-family: 'JetBrains Mono', 'Consolas', monospace; font-size: 1.13em; padding: 0.9em; width: 100%; min-height: 2em; filter: contrast(1.1) brightness(1.1); text-shadow: 0 0 2px #fff2, 0 0 1px #ff2a2a22; animation: term-flicker 2.5s infinite linear alternate; word-break: break-all; }
    @keyframes term-flicker { 0%{opacity:1;} 97%{opacity:1;} 98%{opacity:0.97;} 99%{opacity:1;} 100%{opacity:0.99;} }
    .pc-leds { display: flex; gap: 0.7em; margin-bottom: 1em; justify-content: center; }
    .led { display: inline-block; width: 18px; height: 18px; border-radius: 50%; background: #444; box-shadow: 0 0 8px #0008; border: 2px solid #fff2; opacity: 0.4; filter: brightness(0.7); transition: opacity 0.4s, filter 0.4s, box-shadow 0.4s; }
    .led.on { opacity: 1; filter: brightness(1.2); }
    .led-green { background: #fff; box-shadow: 0 0 12px #fff; }
    .led-yellow { background: #ffeb3b; box-shadow: 0 0 12px #ffeb3b; }
    .led-red { background: #ff2a2a; box-shadow: 0 0 12px #ff2a2a; }
    .pc-keyboard { margin-top: 0.7em; }
    .pc-input { width: 100%; background: #181b1f; color: #fff; border: 1.5px solid #ff2a2a; border-radius: 8px; padding: 0.9em 0.7em; font-size: 1.13em; font-family: inherit; margin-bottom: 0.7em; box-sizing: border-box; }
    .pc-reload { display: block; margin: 0.7em auto 0 auto; background: #181b1f; color: #fff; border: 1.5px solid #fff2; border-radius: 10px; padding: 0.7em 1.5em; font-size: 1.13em; font-family: inherit; cursor: pointer; box-shadow: 0 1px 4px #0006; transition: background 0.15s, color 0.15s; font-weight: 700; letter-spacing: 0.04em; }
    .pc-reload:active { background: #ff2a2a; color: #fff; }
    .sim-progress { width: 100%; background: #23272b; border-radius: 6px; margin: 1em 0 0.5em 0; height: 14px; overflow: hidden; }
    .sim-progress-bar { height: 100%; background: #ff2a2a; width: 0%; transition: width 0.5s; }
    .next-btn {
      background: #ff2a2a;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.7em 1.5em;
      font-size: 1.1em;
      font-family: inherit;
      cursor: pointer;
      margin: 1.2em auto 0 auto;
      display: block;
      transition: background 0.2s;
      box-shadow: 0 1px 6px #0006;
      font-weight: 700;
      letter-spacing: 0.04em;
    }
    .next-btn:active {
      background: #fff;
      color: #ff2a2a;
    }
    @media (min-width: 900px) {
      main { max-width: 700px; }
      .card, .mini-pc, .pc-body { max-width: 700px; margin: 0 auto; }
      .pc-body { padding: 2.2em 2em 2em 2em; }
      .pc-screen { max-height: 220px; }
    }
    @media (max-width: 600px) {
      header h1 { font-size: 1.2rem; }
      .card { padding: 0.7rem 0.3rem; }
      .step-title { padding: 0.2rem 0.1rem; font-size: 1.05rem; }
      .pc-body { max-width: 98vw; width: 98vw; padding: 0.2em 0.01em 0.2em 0.01em; }
      .mini-pc { max-width: 100vw; padding: 0; }
      .pc-terminal, .pc-input { font-size: 16px; }
      .pc-screen { height: 32vw; min-height: 100px; max-height: 140px; }
    }
    @keyframes fadein {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slidein-top {
      from { opacity: 0; transform: translateY(-40px); }
      to { opacity: 1; transform: none; }
    }
    @keyframes slidein-left {
      from { opacity: 0; transform: translateX(-40px); }
      to { opacity: 1; transform: none; }
    }
  </style>
</head>
<body>
  <svg id="cyber-bg" width="100%" height="100%" viewBox="0 0 1920 1080" preserveAspectRatio="none">
    <g id="cyber-lines">
      <polyline points="100,100 400,200 700,100" stroke="#ff2a2a" stroke-width="2" fill="none">
        <animate attributeName="points" values="100,100 400,200 700,100; 120,120 420,220 720,120; 100,100 400,200 700,100" dur="6s" repeatCount="indefinite"/>
      </polyline>
      <polyline points="300,800 800,900 1200,700" stroke="#fff" stroke-width="1.2" fill="none">
        <animate attributeName="points" values="300,800 800,900 1200,700; 320,820 820,920 1220,720; 300,800 800,900 1200,700" dur="7s" repeatCount="indefinite"/>
      </polyline>
      <circle cx="1600" cy="200" r="8" fill="#ff2a2a">
        <animate attributeName="cy" values="200;250;200" dur="3s" repeatCount="indefinite"/>
      </circle>
      <circle cx="200" cy="900" r="5" fill="#fff">
        <animate attributeName="cy" values="900;950;900" dur="4s" repeatCount="indefinite"/>
      </circle>
    </g>
  </svg>
  <header>
    <h1>Мини-курс: Сбой Wi-Fi с помощью aireplay-ng</h1>
    <div class="subtitle">Тёмная тема • Мобильная адаптация • Стальной акцент</div>
  </header>
  <main>
    <div class="progress"><div class="progress-bar" id="progress-bar"></div></div>
    <div id="steps"></div>
    <button class="next-btn" id="next-btn" style="display:none;">Далее</button>
  </main>
  <script>
    // Этапы курса
    const steps = [
      {
        title: 'Введение',
        content: `<p><b>Deauth-атака</b> — это способ временно отключить устройства от Wi-Fi сети, отправляя специальные пакеты (deauthentication) на точку доступа. Это используется для тестирования безопасности, но <b>запрещено применять на чужих сетях</b>!<br><br>
        <b>aireplay-ng</b> — часть пакета aircrack-ng, позволяет отправлять такие пакеты. В этом курсе вы узнаете, как это работает, и попробуете симуляцию на мини-компьютере.<br><br>
        <span style='color:var(--danger)'>Всё, что вы увидите — только для обучения и тестирования своих сетей!</span></p>`
      },
      {
        title: 'Как работает deauth-атака?',
        content: `<p>Wi-Fi работает по стандарту IEEE 802.11. Любое устройство может отправить deauth-пакет, чтобы отключить клиента от точки доступа.<br>
        <b>aireplay-ng</b> позволяет отправлять такие пакеты массово, вызывая сбой соединения у всех клиентов.<br><br>
        <b>Пример сценария:</b><br>
        1. Перевести адаптер в режим мониторинга<br>
        2. Найти нужную сеть (BSSID)<br>
        3. Отправить deauth-пакеты<br>
        4. Клиенты теряют соединение и пытаются переподключиться</p>`
      },
      {
        title: 'Шаг 1: Подготовка',
        content: `<p>Для начала убедитесь, что у вас есть Wi-Fi адаптер с поддержкой режима мониторинга и установлен пакет <b>aircrack-ng</b>.<br>В реальной жизни для тестирования используйте только свои сети!</p>
        <div class="terminal"><span class="prompt">$</span> sudo apt update && sudo apt install aircrack-ng</div>`
      },
      {
        title: 'Шаг 2: Перевод адаптера в режим мониторинга',
        content: `<p>Переведите Wi-Fi адаптер в режим мониторинга (пример для интерфейса <b>wlan0</b>):</p>
        <div class="terminal"><span class="prompt">$</span> sudo airmon-ng start wlan0</div>`
      },
      {
        title: 'Шаг 3: Поиск сетей',
        content: `<p>Сканируем эфир для поиска доступных Wi-Fi сетей:</p>
        <div class="terminal"><span class="prompt">$</span> sudo airodump-ng wlan0mon</div>`
      },
      {
        title: 'Шаг 4: Деаутентификация клиентов',
        content: `<p>Для сбоя работы сети отправим deauth-пакеты:<br>Замените <b>[BSSID]</b> на MAC-адрес точки доступа, <b>[iface]</b> — на ваш интерфейс (например, wlan0mon):</p>
        <div class="terminal"><span class="prompt">$</span> sudo aireplay-ng --deauth 10 -a [BSSID] [iface]</div>`
      },
      {
        title: 'Тест: Команда для режима мониторинга',
        content: `<div class="test">
          <label>Введите команду для перевода адаптера wlan0 в режим мониторинга:</label>
          <input type="text" id="test1" autocomplete="off" placeholder="...">
          <button onclick="checkTest1()">Проверить</button>
          <div class="result" id="result1"></div>
        </div>`
      },
      {
        title: 'Тест: Команда деаутентификации',
        content: `<div class="test">
          <label>Введите команду для отправки 10 deauth-пакетов (BSSID: 11:22:33:44:55:66, iface: wlan0mon):</label>
          <input type="text" id="test2" autocomplete="off" placeholder="...">
          <button onclick="checkTest2()">Проверить</button>
          <div class="result" id="result2"></div>
        </div>`
      },
      {
        title: 'Симулятор атаки',
        content: `<div class="mini-pc">
          <div class="pc-body">
            <div class="pc-screen" id="pc-screen">
              <div class="pc-terminal" id="pc-terminal">
                <span class="pc-prompt">user@pentest:~$</span> <span id="pc-cmd"></span><span class="pc-cursor" id="pc-cursor">█</span>
              </div>
            </div>
            <div class="pc-leds">
              <span class="led led-green" id="led-power"></span>
              <span class="led led-yellow" id="led-net"></span>
              <span class="led led-red" id="led-attack"></span>
            </div>
            <div class="pc-keyboard">
              <input class="pc-input" id="pc-input" autocomplete="off" placeholder="Введите команду и Enter">
            </div>
          </div>
        </div>
        <div class="sim-output" id="sim-output"></div>
        <div class="sim-progress" id="sim-progress" style="display:none;"><div class="sim-progress-bar" id="sim-progress-bar"></div></div>
        <div style="text-align:center;margin-top:1em;color:var(--accent2);font-size:0.98em;">Попробуйте пройти все этапы атаки на мини-компьютере!</div>`
      },
      {
        title: 'Поздравляем!',
        content: `<p>Вы прошли мини-курс и попробовали симуляцию сбоя Wi-Fi с помощью aireplay-ng.<br>Используйте эти знания только в легальных целях и для тестирования своих сетей!</p>`
      }
    ];

    let currentStep = 0;
    const stepsDiv = document.getElementById('steps');
    const nextBtn = document.getElementById('next-btn');
    const progressBar = document.getElementById('progress-bar');

    function renderStep() {
      stepsDiv.innerHTML = '';
      const step = steps[currentStep];
      const card = document.createElement('div');
      card.className = 'card active';
      card.innerHTML = `<div class="step-title">${step.title}</div>${step.content}`;
      stepsDiv.appendChild(card);
      // Кнопка далее
      if (currentStep < steps.length - 1) {
        nextBtn.style.display = 'block';
        nextBtn.disabled = (step.title.startsWith('Тест') || step.title.startsWith('Симулятор'));
      } else {
        nextBtn.style.display = 'none';
      }
      // Прогресс
      progressBar.style.width = ((currentStep) / (steps.length - 1) * 100) + '%';
      // Вызов setupMiniPC при рендере этапа симулятора
      if (step.title === 'Симулятор атаки') {
        setTimeout(setupMiniPC, 100);
      }
    }

    nextBtn.onclick = function() {
      if (currentStep < steps.length - 1) {
        currentStep++;
        renderStep();
      }
    };

    // Тест 1: команда для режима мониторинга
    window.checkTest1 = function() {
      const val = document.getElementById('test1').value.trim();
      const res = document.getElementById('result1');
      if (/^sudo\s+airmon-ng\s+start\s+wlan0$/i.test(val)) {
        res.innerHTML = '<span style="color:var(--success)">Верно!</span>';
        nextBtn.disabled = false;
      } else {
        res.innerHTML = '<span style="color:var(--danger)">Неверно. Попробуйте ещё раз.</span>';
      }
    };
    // Тест 2: команда деаутентификации
    window.checkTest2 = function() {
      const val = document.getElementById('test2').value.trim();
      const res = document.getElementById('result2');
      if (/^sudo\s+aireplay-ng\s+--deauth\s+10\s+-a\s+11:22:33:44:55:66\s+wlan0mon$/i.test(val)) {
        res.innerHTML = '<span style="color:var(--success)">Верно!</span>';
        nextBtn.disabled = false;
      } else {
        res.innerHTML = '<span style="color:var(--danger)">Неверно. Попробуйте ещё раз.</span>';
      }
    };
    // Симулятор атаки
    window.runSim = function() {
      const val = document.getElementById('sim-cmd').value.trim();
      const out = document.getElementById('sim-output');
      if (/^sudo\s+aireplay-ng\s+--deauth\s+10\s+-a\s+11:22:33:44:55:66\s+wlan0mon$/i.test(val)) {
        out.innerHTML = 'Отправка deauth-пакетов...<br>Клиенты отключены! <span style="color:var(--success)">[Успех]</span>';
        nextBtn.disabled = false;
      } else if (val) {
        out.innerHTML = '<span style="color:var(--danger)">Ошибка: неправильная команда.</span>';
      } else {
        out.innerHTML = '';
      }
    };

    // Добавить стили для мини-компьютера и анимаций
    const style = document.createElement('style');
    style.innerHTML = `
    .mini-pc { display: flex; justify-content: center; margin: 1.2em 0; width: 100%; max-width: 100vw; overflow-x: hidden; box-sizing: border-box; min-width: 0; }
    .pc-body { background: rgba(24,27,31,0.98); border-radius: 18px; box-shadow: 0 4px 32px #000a; padding: 1.2em 1em 1em 1em; width: 98vw; max-width: 400px; min-width: 0; position: relative; border: 2px solid #fff2; margin: 0 auto; overflow: hidden; box-sizing: border-box; }
    .pc-feet { position: absolute; left: 18px; right: 18px; bottom: -16px; display: flex; justify-content: space-between; }
    .pc-foot { width: 32px; height: 12px; background: #444d57; border-radius: 6px 6px 12px 12px; box-shadow: 0 2px 8px #0008; }
    .pc-screen { background: #111216; border-radius: 12px; box-shadow: 0 2px 12px #0008, 0 0 0 2px #fff2 inset; width: 100%; min-height: 100px; height: 32vw; max-height: 180px; margin-bottom: 1em; display: flex; align-items: flex-end; overflow: hidden; position: relative; min-width: 0; max-width: 100%; box-sizing: border-box; border: 2px solid #fff2; }
    .pc-screen::after { content: ''; position: absolute; left: 12px; top: 12px; width: 65%; height: 22px; background: linear-gradient(90deg, #fff2 10%, #fff1 60%, transparent 100%); border-radius: 10px; opacity: 0.16; pointer-events: none; }
    .pc-terminal { color: #fff; font-family: 'JetBrains Mono', 'Consolas', monospace; font-size: 1.13em; padding: 0.9em; width: 100%; min-height: 2em; filter: contrast(1.1) brightness(1.1); text-shadow: 0 0 2px #fff2, 0 0 1px #ff2a2a22; animation: term-flicker 2.5s infinite linear alternate; word-break: break-all; }
    @keyframes term-flicker { 0%{opacity:1;} 97%{opacity:1;} 98%{opacity:0.97;} 99%{opacity:1;} 100%{opacity:0.99;} }
    .pc-leds { display: flex; gap: 0.7em; margin-bottom: 1em; justify-content: center; }
    .led { display: inline-block; width: 18px; height: 18px; border-radius: 50%; background: #444; box-shadow: 0 0 8px #0008; border: 2px solid #fff2; opacity: 0.4; filter: brightness(0.7); transition: opacity 0.4s, filter 0.4s, box-shadow 0.4s; }
    .led.on { opacity: 1; filter: brightness(1.2); }
    .led-green { background: #fff; box-shadow: 0 0 12px #fff; }
    .led-yellow { background: #ffeb3b; box-shadow: 0 0 12px #ffeb3b; }
    .led-red { background: #ff2a2a; box-shadow: 0 0 12px #ff2a2a; }
    .pc-keyboard { margin-top: 0.7em; }
    .pc-input { width: 100%; background: #181b1f; color: #fff; border: 1.5px solid #ff2a2a; border-radius: 8px; padding: 0.9em 0.7em; font-size: 1.13em; font-family: inherit; margin-bottom: 0.7em; box-sizing: border-box; }
    .sim-progress { width: 100%; background: #23272b; border-radius: 6px; margin: 1em 0 0.5em 0; height: 14px; overflow: hidden; }
    .sim-progress-bar { height: 100%; background: #ff2a2a; width: 0%; transition: width 0.5s; }
    @media (max-width: 600px) {
      .pc-body { max-width: 98vw; width: 98vw; padding: 0.2em 0.01em 0.2em 0.01em; }
      .mini-pc { max-width: 100vw; padding: 0; }
      .pc-terminal, .pc-input { font-size: 16px; }
      .pc-screen { height: 32vw; min-height: 100px; max-height: 140px; }
      .card { padding: 0.7rem 0.3rem; }
      .step-title { padding: 0.2rem 0.1rem; }
    }
    @media (max-width: 400px) { .pc-body { max-width: 100vw; } }
    `;
    document.head.appendChild(style);

    // Симулятор мини-компьютера
    function setupMiniPC() {
      const pcInput = document.getElementById('pc-input');
      const pcTerminal = document.getElementById('pc-terminal');
      const pcCmd = document.getElementById('pc-cmd');
      const pcCursor = document.getElementById('pc-cursor');
      const ledPower = document.getElementById('led-power');
      const ledNet = document.getElementById('led-net');
      const ledAttack = document.getElementById('led-attack');
      const simOutput = document.getElementById('sim-output');
      const simProgress = document.getElementById('sim-progress');
      const simProgressBar = document.getElementById('sim-progress-bar');
      // Проверка наличия всех нужных элементов
      if (!pcInput || !pcTerminal || !pcCmd || !pcCursor || !ledPower || !ledNet || !ledAttack || !simOutput || !simProgress || !simProgressBar) {
        setTimeout(setupMiniPC, 100);
        return;
      }
      // Добавить ножки и кнопку перезагрузки
      const pcBody = document.querySelector('.pc-body');
      if (!document.querySelector('.pc-feet')) {
        const feet = document.createElement('div');
        feet.className = 'pc-feet';
        feet.innerHTML = '<div class="pc-foot"></div><div class="pc-foot"></div>';
        pcBody.appendChild(feet);
      }
      if (!document.querySelector('.pc-reload')) {
        const reloadBtn = document.createElement('button');
        reloadBtn.className = 'pc-reload';
        reloadBtn.textContent = 'Перезагрузить мини-компьютер';
        reloadBtn.onclick = resetSim;
        pcBody.appendChild(reloadBtn);
      }
      // Анимация загрузки
      function bootAnim() {
        pcTerminal.innerHTML = '';
        let lines = [
          'Booting mini-pc...','[OK] Power','[OK] BIOS','[OK] Loading OS','[OK] Network','user@pentest:~$'
        ];
        let i=0;
        setLED(ledPower, 1); setLED(ledNet, 0); setLED(ledAttack, 0);
        function nextLine() {
          if (i<lines.length) {
            const span = document.createElement('span');
            span.textContent = lines[i]+'\n';
            span.style.color = i<2?'#81c784':(i<4?'#b0c4de':'#7a8ca5');
            pcTerminal.appendChild(span);
            pcTerminal.scrollTop = pcTerminal.scrollHeight;
            i++;
            setTimeout(nextLine, 350);
          } else {
            pcTerminal.innerHTML += '<span class="pc-prompt">user@pentest:~$</span> <span id="pc-cmd"></span><span class="pc-cursor" id="pc-cursor">█</span>';
            setLED(ledNet, 0.7);
            setLED(ledAttack, 0);
            pcInput.disabled = false;
            pcInput.focus();
          }
        }
        pcInput.disabled = true;
        nextLine();
      }
      function setLED(led, on) {
        if (on) led.classList.add('on'); else led.classList.remove('on');
      }
      function printTerminal(text, color) {
        const span = document.createElement('span');
        span.textContent = text + '\n';
        if (color) span.style.color = color;
        pcTerminal.appendChild(span);
        pcTerminal.scrollTop = pcTerminal.scrollHeight;
      }
      function resetSim() {
        pcTerminal.innerHTML = '';
        simOutput.textContent = '';
        simProgress.style.display = 'none';
        simProgressBar.style.width = '0%';
        setLED(ledPower, 1); setLED(ledNet, 0); setLED(ledAttack, 0);
        stage = 0; history = [];
        bootAnim();
      }
      let stage = 0;
      let history = [];
      let busy = false;
      resetSim();
      pcInput.value = '';
      pcInput.focus();
      pcInput.onkeydown = function(e) {
        if (busy) return;
        if (e.key === 'Enter') {
          const cmd = pcInput.value.trim();
          if (!cmd) return;
          history.push(cmd);
          pcTerminal.innerHTML += '\n<span class="pc-prompt">user@pentest:~$</span> ' + cmd;
          pcInput.value = '';
          pcCmd.textContent = '';
          // Сценарии этапов
          if (stage === 0 && /^sudo\s+airmon-ng\s+start\s+wlan0$/i.test(cmd)) {
            setLED(ledNet, 1);
            printTerminal('Переводим wlan0 в режим мониторинга... [OK]', '#81c784');
            stage = 1;
          } else if (stage === 1 && /^sudo\s+airodump-ng\s+wlan0mon$/i.test(cmd)) {
            printTerminal('Сканирование сетей...\nBSSID              PWR  Beacons    #Data, #/s  CH  MB   ENC  CIPHER AUTH ESSID\n11:22:33:44:55:66  -40      100        0    0   6  54e  WPA2 CCMP   PSK  testwifi', '#b0c4de');
            stage = 2;
          } else if (stage === 2 && /^sudo\s+aireplay-ng\s+--deauth\s+10\s+-a\s+11:22:33:44:55:66\s+wlan0mon$/i.test(cmd)) {
            setLED(ledAttack, 1);
            simProgress.style.display = 'block';
            simProgressBar.style.width = '0%';
            busy = true;
            let prog = 0;
            printTerminal('Отправка deauth-пакетов...', '#e57373');
            const interval = setInterval(() => {
              prog += 20;
              simProgressBar.style.width = prog + '%';
              if (prog >= 100) {
                clearInterval(interval);
                printTerminal('Клиенты отключены! [Успех]', '#81c784');
                simOutput.innerHTML = '<span style="color:var(--success)">Атака завершена успешно!</span>';
                setLED(ledAttack, 0);
                busy = false;
                nextBtn.disabled = false;
              }
            }, 500);
            stage = 3;
          } else {
            printTerminal('bash: команда не найдена или не на этом этапе', '#e57373');
          }
        } else {
          setTimeout(() => {
            pcCmd.textContent = pcInput.value;
          }, 0);
        }
      };
      // Не перекрывать экран клавиатурой на мобильных
      pcInput.scrollIntoView({block:'center'});
    }

    // Инициализация
    renderStep();
  </script>
</body>
</html>
